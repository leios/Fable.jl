<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Rotating Square · Fae.jl</title><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="Fae.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../../">Fae.jl</a></span></div><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><a class="tocitem" href="../../general_info/">General Information</a></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Rotating Square</a><ul class="internal"><li><a class="tocitem" href="#Step-1:-create-a-square"><span>Step 1: create a square</span></a></li><li><a class="tocitem" href="#Step-2:-swirl-the-square"><span>Step 2: swirl the square</span></a></li><li><a class="tocitem" href="#Step-3:-a-different-kind-of-swirl"><span>Step 3: a different kind of swirl</span></a></li></ul></li><li><a class="tocitem" href="../smear/">Simple Smears</a></li></ul></li><li><a class="tocitem" href="../../research_directions/">Research Directions</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Rotating Square</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Rotating Square</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/leios/Fae.jl/blob/main/docs/src/examples/swirled_square.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="A-Swirled-Square"><a class="docs-heading-anchor" href="#A-Swirled-Square">A Swirled Square</a><a id="A-Swirled-Square-1"></a><a class="docs-heading-anchor-permalink" href="#A-Swirled-Square" title="Permalink"></a></h1><p>This is a quick example to show how to use Fae.jl</p><h2 id="Step-1:-create-a-square"><a class="docs-heading-anchor" href="#Step-1:-create-a-square">Step 1: create a square</a><a id="Step-1:-create-a-square-1"></a><a class="docs-heading-anchor-permalink" href="#Step-1:-create-a-square" title="Permalink"></a></h2><p>First, we should create a square. To do this, we need to set up Fae with the right parameters:</p><pre><code class="nohighlight hljs">    # Physical space location. 
    bounds = [-4.5 4.5; -8 8]*0.15

    # Pixel grid
    res = (1080, 1920)

    # parameters for initial square
    pos = [0.0, 0.0]
    rotation = pi/4
    scale_x = 1.0
    scale_y = 1.0</code></pre><p>Note that this sets up an image resolution, <code>res</code>, and a separate camera with physical units, <code>bounds</code>, so if we are using a 1920 by 1080 image, the <code>bounds</code> can be anything with a 16:9 ratio. Here, we also set the position, <code>pos</code>, the <code>rotation</code>, and scaling factors in x and y, <code>scale_x</code> and <code>scale_y</code>.</p><p>Now we need to define a color. This can be done by passing in an array or tuple (such as <code>color = [1.0, 0, 0, 1]</code> for red), or as an array of arrays or tuples, like:</p><pre><code class="nohighlight hljs">    colors = [[1.0, 0.25, 0.25,1],
              [0.25, 1.0, 0.25, 1],
              [0.25, 0.25, 1.0, 1],
              [1.0, 0.25, 1.0, 1]]
</code></pre><p>In this case, each row of the array will define the color of a different quadrant of the square. Now we can define our fractal executable...</p><pre><code class="nohighlight hljs">H = Fae.define_rectangle(pos, rotation, scale_x, scale_y, colors; AT = AT)</code></pre><p>Here, <code>AT</code> can be either an <code>Array</code> or <code>CuArray</code> depending whether you would like to run the code on the CPU or (CUDA) GPU. <code>num_particles</code> and <code>num_iterations</code> are the number of points we are solving with for the chaos game and the number of iterations for each point. The higher these numbers are, the better resolved our final image will be. Notationally, we are using the variable <code>H</code> to designate a Hutchinson operator, which is the mathematical name for a function set.</p><p>Finally, we solve the function system with the <code>fractal_flame(...)</code> function and write it to an image:</p><pre><code class="nohighlight hljs">    pix = Fae.fractal_flame(H, num_particles, num_iterations,
                            bounds, res; AT = AT, FT = FT)

    filename = &quot;out.png&quot;
    write_image([pix], filename)
</code></pre><p>This should provide the following image:</p><p><img src="../res/swirled_square_1.png" alt="a simple square"/></p><p>The full code will look like </p><pre><code class="nohighlight hljs">function main(num_particles, num_iterations, AT; dark = true)
    FT = Float32

    # Physical space location. 
    bounds = [-4.5 4.5; -8 8]*0.15

    # Pixel grid
    res = (1080, 1920)

    # parameters for initial square
    pos = [0.0, 0.0]
    rotation = pi/4
    scale_x = 1.0
    scale_y = 1.0

    if dark
        colors = [[1.0, 0.25, 0.25,1],
                  [0.25, 1.0, 0.25, 1],
                  [0.25, 0.25, 1.0, 1],
                  [1.0, 0.25, 1.0, 1]]
    else
        colors = [[1.0, 0, 0,1],
                 [0, 1.0, 0, 1],
                 [0, 0, 1.0, 1],
                 [1.0, 0, 1.0, 1]]
    end

    H = Fae.define_rectangle(pos, rotation, scale_x, scale_y, colors; AT = AT)

    pix = Fae.fractal_flame(H, num_particles, num_iterations,
                            bounds, res; AT = AT, FT = FT)

    filename = &quot;out.png&quot;
    write_image([pix], filename;
                img = fill(RGBA(0,0,0,0), size(pix.values)))
end
</code></pre><h2 id="Step-2:-swirl-the-square"><a class="docs-heading-anchor" href="#Step-2:-swirl-the-square">Step 2: swirl the square</a><a id="Step-2:-swirl-the-square-1"></a><a class="docs-heading-anchor-permalink" href="#Step-2:-swirl-the-square" title="Permalink"></a></h2><p>Next, we will try to &quot;swirl the square&quot; by also adding another fractal executable to the mix, the swirl operator (defined already in Fae.jl):</p><pre><code class="nohighlight hljs">swirl = @fum function swirl(x, y)
    r = sqrt(y*y + x*x)

    v1 = x*cos(r*r) + y*sin(r*r)
    v2 = x*sin(r*r) - y*cos(r*r)

    y = v1
    x = v2
end</code></pre><p>Here, we are using the <code>@fum</code> syntax to show how users might define their own operators. The same can be done for colors.</p><p>The code here does not change significantly, except that we create a <code>H2</code> and add it to the <code>fractal_flame(...)</code> function:</p><pre><code class="nohighlight hljs">...
    H2 = Hutchinson([Flames.swirl],
                    [Fae.Colors.previous],
                    (1.0,);
                    final = true, diagnostic = true, AT = AT, name = &quot;2&quot;)

    pix = Fae.fractal_flame(H1, H2, num_particles, num_iterations,
                            bounds, res; AT = AT, FT = FT)
...</code></pre><p>There are a few nuances to point out:</p><ol><li>We are using <code>Fae.Colors.previous</code>, which simply means that the swirl will use whatever colors were specified in <code>H1</code>.</li><li>Fractal operators can be called with <code>fee</code> or <code>Hutchinson</code> and require <code>Array</code> or <code>Tuple</code> inputs.</li><li><code>final = true</code>, means that this is a post processing operation. In other words, <code>H1</code> creates the object primitive (square), and <code>H2</code> always operates on that square.</li><li>We are specifying the Floating Type, <code>FT</code>, as <code>Float32</code>, but that is not necessary.</li></ol><p>Once this is run, it should provide the following image:</p><p><img src="../res/swirled_square_2.png" alt="a swirled square"/></p><h2 id="Step-3:-a-different-kind-of-swirl"><a class="docs-heading-anchor" href="#Step-3:-a-different-kind-of-swirl">Step 3: a different kind of swirl</a><a id="Step-3:-a-different-kind-of-swirl-1"></a><a class="docs-heading-anchor-permalink" href="#Step-3:-a-different-kind-of-swirl" title="Permalink"></a></h2><p>Now some people might be scratching their heads at the previous result. If we are solving with both <code>H1</code> and <code>H2</code>, why does it look like two separate actions instead of one combined one? In other words, why is the swirl so clearly different than the square operation?</p><p>This is because we operate on two separate sets of points. <code>H1</code> creates object primitives. Every step of the simulation, we will read from the points after <code>H1</code> operates on them. <code>H2</code> works on a completely different location in memory specifically for image output. If we want, we can make <code>H2</code> operate on the object, itself, by creating a new fractal executable:</p><pre><code class="nohighlight hljs">    final_H = fee([H, H2])

    pix = Fae.fractal_flame(final_H, num_particles, num_iterations,
                            bounds, res; AT = AT, FT = FT)</code></pre><p>which will create the following image:</p><p><img src="../res/swirled_square_3.png" alt="a swirled square (again)"/></p><p>Here, again, is the full code:</p><pre><code class="nohighlight hljs">function main(num_particles, num_iterations, AT; dark = true)
    FT = Float32

    # Physical space location. 
    bounds = [-4.5 4.5; -8 8]*0.15

    # Pixel grid
    res = (1080, 1920)

    # parameters for initial square
    pos = [0.0, 0.0]
    rotation = pi/4
    scale_x = 1.0
    scale_y = 1.0

    if dark
        colors = [[1.0, 0.25, 0.25,1],
                  [0.25, 1.0, 0.25, 1],
                  [0.25, 0.25, 1.0, 1],
                  [1.0, 0.25, 1.0, 1]]
    else
        colors = [[1.0, 0, 0,1],
                 [0, 1.0, 0, 1],
                 [0, 0, 1.0, 1],
                 [1.0, 0, 1.0, 1]]
    end

    H = Fae.define_rectangle(pos, rotation, scale_x, scale_y, colors; AT = AT)
    H2 = Hutchinson([Flames.swirl],
                    [Fae.Colors.previous],
                    (1.0,);
                    diagnostic = true, AT = AT, name = &quot;2&quot;)
    final_H = fee([H, H2])

    pix = Fae.fractal_flame(final_H, num_particles, num_iterations,
                            bounds, res; AT = AT, FT = FT)

    filename = &quot;out.png&quot;
    write_image([pix], filename)
end
</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../general_info/">« General Information</a><a class="docs-footer-nextpage" href="../smear/">Simple Smears »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Thursday 8 September 2022 15:14">Thursday 8 September 2022</span>. Using Julia version 1.6.7.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
